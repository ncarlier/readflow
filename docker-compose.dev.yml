version: "3"

services:
  #######################################
  # Postgres: The database
  #######################################
  db:
    image: postgres:14
    restart: always
    environment:
      POSTGRES_DB: ${POSTGRES_DB:-readflow_test}
      POSTGRES_USER: ${POSTGRES_USER:-postgres}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-testpwd}
    ports:
      - "${POSTGRES_PORT:-5432}:5432"
  #######################################
  # Imagor: Image proxy
  #######################################
  imagor:
    image: shumc/imagor
    command: -debug -imagor-auto-webp
    environment:
      IMAGOR_SECRET: ${READFLOW_HASH_SECRET_SALT:-pepper}
    ports:
      - "${IMAGOR_PORT:-8081}:8000"
  #######################################
  # Goenberg: PDF generator
  #######################################
  gotenberg:
    image: gotenberg/gotenberg:7
    ports:
      - "${GOTENBERG:-3001}:3000"